syntax = "proto3";

import "google/protobuf/timestamp.proto";

service falco_output_service {
  rpc subscribe(falco_output_request) returns (stream falco_output_response);
}

message falco_output_request {
  string duration = 1; // TODO(leodido, fntlnz): not handled yet but keeping for reference.
  bool keepalive = 2;
}

enum priority {
  EMERGENCY = 0;
  ALERT = 1;
  CRITICAL = 2;
  ERROR = 3;
  WARNING = 4;
  NOTICE = 5;
  INFORMATIONAL = 6;
  DEBUG = 7;
}

enum source {
  SYSCALL = 0;
  K8S_AUDIT = 1;
}

message falco_output_response {
  string id = 1;
  google.protobuf.Timestamp time = 2;
  priority priority = 3;
  source source = 4;
  string rule = 5;
  string output = 6;
  map<string, string> output_fields = 7;
}